/*!
 * Angular Responsive Parallax
 *
 * (c) 2014-2015 Markus Riegel <riegel.markus@googlemail.com>
 * License: MIT
 */
!function(t,e,n){var i=e.module("mrResponsiveParallax",[]);i.value("containerDivId","mr-px-container"),i.directive("mrPxParallax",["containerDivId","$timeout",function(i,o){return{restrict:"A",scope:{mrPxMaxPx:"="},link:function(r,a,l){var s,h,d,c,p,m,u,g,x=function(){if(!s){var t=document.getElementById(i);null===t?(t=e.element('<div style="position:fixed;left:0;top:0;z-index:0;width:100%;height:100%;"></div>'),t.attr("id",i),e.element(document.body).prepend(t)):t=e.element(t),s=e.element('<div style="position:fixed;left:0;top:0;width:100%;height:100%;overflow:hidden;"></div>'),h=e.element('<img style="position:absolute;">'),t.append(s),s.append(h)}var n=a.find("img"),o=n.parent(),r=o.attr("mr-px-size").split(","),l="true"===o.attr("mr-px-no-px"),d=parseFloat(o.attr("mr-px-focal"))>=-1&&parseFloat(o.attr("mr-px-focal"))<=1?parseFloat(o.attr("mr-px-focal")):0;return l?(s.css("display","none"),h.attr("src",""),a.css("display","block")):(s.css("display","block"),h.attr("src",n.attr("src")),a.css("display","none")),{elem:n,oWidth:parseInt(r[0]),oHeight:parseInt(r[1]),noPx:l,focal:d}},f=function(){e.element(t).unbind("scroll",k),p=x(),m=parseFloat(r.mrPxMaxPx),u={width:t.innerWidth||document.documentElement.clientWidth,height:t.innerHeight||document.documentElement.clientHeight},p.noPx===!0?m=0:e.element(t).bind("scroll",k)},v=function(){var t=d[0].getBoundingClientRect();c={width:u.width,height:0},m>=0&&1>=m&&(c.height=u.height*(1-m)+t.height*m);var e=p.noPx?t:c,n=p.noPx?p.elem:h,i=e.width/e.height,o=p.oWidth/p.oHeight;o>i?(p.height=e.height,p.width=p.height*o):(p.width=e.width,p.height=p.width/o),n.css("width",p.width+"px"),n.css("height",p.height+"px"),s.css("height",t.height+"px")},w=function(){var t,e=d[0].getBoundingClientRect(),n=0,i=0,o=m,r=p.noPx?p.elem:h;t=.5*-(p.width-c.width),p.noPx?i=.5*-(p.height-e.height):(n=e.top/(u.height-e.height),m>=0&&1>=m&&(i=(u.height-c.height)*n*(1-o)+e.top*o),i=i-e.top-.5*(p.height-c.height)*(1-p.focal)),"none"!==g?(s.css(g,"translate3d(0px,"+e.top+"px,0)"),r.css(g,"translate3d("+t+"px, "+i+"px,0px)")):(s.css("top",e.top+"px"),r.css("top",i+"px"),r.css("left",t+"px"))},y=function(){e.element(t).unbind("resize",z),e.element(t).unbind("scroll",k),s&&(s.parent().remove(s),h=null)},b=function(){var e,i,o=document.createElement("p"),r={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(o,null);for(var a in r)o.style[a]!==n&&(o.style[a]="translate3d(1px,1px,1px)",e=t.getComputedStyle(o).getPropertyValue(r[a]),i=a);return document.body.removeChild(o),e!==n&&e.length>0&&"none"!==e?i:"none"},P=function(){e.element(t).unbind("load",P),e.element(t).bind("resize",z),z()},z=function(){f(),v(),k()},k=function(){w()};g=b(),d=a.parent(),a.css("display","none"),o(P),r.$on("$destroy",function(){y()})}}}])}(window,window.angular);